{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///home/muhammedshibilin/nextjs/harfa/lib/paseto.ts"],"sourcesContent":["// lib/paseto.ts\nimport { V4 } from 'paseto';\nimport { Buffer } from 'node:buffer';\n\n// Instantiate V4\n\nconst privateKey = (() => {\n  const key = process.env.PASETO_PRIVATE_KEY;\n  if (!key) throw new Error('PASETO_PRIVATE_KEY is missing from environment variables');\n  console.log('Private Key:', key, 'Length (chars):', key.length);\n  const buffer = Buffer.from(key, 'base64');\n  if (buffer.length !== 64) {\n    console.error(`Private key length is ${buffer.length}, expected 64 bytes`);\n    throw new Error('Invalid PASETO_PRIVATE_KEY length');\n  }\n  return buffer;\n})();\n\nconst publicKey = (() => {\n  const key = process.env.PASETO_PUBLIC_KEY;\n  if (!key) throw new Error('PASETO_PUBLIC_KEY is missing from environment variables');\n  console.log('Public Key:', key, 'Length (chars):', key.length);\n  const buffer = Buffer.from(key, 'base64');\n  if (buffer.length !== 32) {\n    console.error(`Public key length is ${buffer.length}, expected 32 bytes`);\n    throw new Error('Invalid PASETO_PUBLIC_KEY length');\n  }\n  return buffer;\n})();\n\ninterface TokenPayload {\n  role: string;\n  username: string;\n  iat?:Date;\n  exp?:Date;\n  iss?:string;\n  sub?:string\n}\n\nexport async function generateToken(payload: TokenPayload): Promise<string> {\n  try {\n    const payloadObject: Record<string, unknown> = { ...payload };\n    console.log('ypayload object',payloadObject)\n    return await V4.sign(payloadObject, privateKey, {\n      expiresIn: '1h',\n      audience: 'http://localhost:3000',\n      issuer: 'http://localhost:3000/backend',\n      subject: payload.username,\n    });\n  } catch (error) {\n    console.error('Failed to generate PASETO token:', error);\n    throw new Error('Token generation failed');\n  }\n}\n\nexport async function verifyToken(token: string): Promise<TokenPayload | null> {\n    try {\n      console.log('Verifying token:', token);\n      const verified = await V4.verify(token, publicKey, {\n        audience: 'http://localhost:3000',\n        issuer: 'http://localhost:3000/backend',\n      });\n  \n      console.log('Verified payload:', verified);\n      return verified as unknown as TokenPayload\n    } catch (error) {\n      console.warn('Failed to verify PASETO token:', error);\n      return null;\n    }\n  }\n  \n"],"names":[],"mappings":"AAAA,gBAAgB;;;;;AAChB;AACA;;;AAEA,iBAAiB;AAEjB,MAAM,aAAa,CAAC;IAClB,MAAM,MAAM,QAAQ,GAAG,CAAC,kBAAkB;IAC1C,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,QAAQ,GAAG,CAAC,gBAAgB,KAAK,mBAAmB,IAAI,MAAM;IAC9D,MAAM,SAAS,qHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,KAAK;IAChC,IAAI,OAAO,MAAM,KAAK,IAAI;QACxB,QAAQ,KAAK,CAAC,CAAC,sBAAsB,EAAE,OAAO,MAAM,CAAC,mBAAmB,CAAC;QACzE,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT,CAAC;AAED,MAAM,YAAY,CAAC;IACjB,MAAM,MAAM,QAAQ,GAAG,CAAC,iBAAiB;IACzC,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,QAAQ,GAAG,CAAC,eAAe,KAAK,mBAAmB,IAAI,MAAM;IAC7D,MAAM,SAAS,qHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,KAAK;IAChC,IAAI,OAAO,MAAM,KAAK,IAAI;QACxB,QAAQ,KAAK,CAAC,CAAC,qBAAqB,EAAE,OAAO,MAAM,CAAC,mBAAmB,CAAC;QACxE,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT,CAAC;AAWM,eAAe,cAAc,OAAqB;IACvD,IAAI;QACF,MAAM,gBAAyC;YAAE,GAAG,OAAO;QAAC;QAC5D,QAAQ,GAAG,CAAC,mBAAkB;QAC9B,OAAO,MAAM,wIAAA,CAAA,KAAE,CAAC,IAAI,CAAC,eAAe,YAAY;YAC9C,WAAW;YACX,UAAU;YACV,QAAQ;YACR,SAAS,QAAQ,QAAQ;QAC3B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oCAAoC;QAClD,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,eAAe,YAAY,KAAa;IAC3C,IAAI;QACF,QAAQ,GAAG,CAAC,oBAAoB;QAChC,MAAM,WAAW,MAAM,wIAAA,CAAA,KAAE,CAAC,MAAM,CAAC,OAAO,WAAW;YACjD,UAAU;YACV,QAAQ;QACV;QAEA,QAAQ,GAAG,CAAC,qBAAqB;QACjC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,IAAI,CAAC,kCAAkC;QAC/C,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///home/muhammedshibilin/nextjs/harfa/lib/db.ts"],"sourcesContent":["import mongoose from 'mongoose';\n\nconst MONGODB_URI = process.env.MONGO_URI;\n\nif (!MONGODB_URI) {\n  throw new Error('Please define MONGODB_URI in .env.local');\n}\n\ninterface Cached {\n  conn: typeof mongoose | null;\n  promise: Promise<typeof mongoose> | null;\n}\n\nlet cached: Cached = (global as any).mongoose;\n\nif (!cached) {\n  cached = (global as any).mongoose = { conn: null, promise: null };\n}\n\nexport async function dbConnect(): Promise<typeof mongoose> {\n  if (cached.conn) return cached.conn;\n\n  if (!cached.promise) {\n    const opts = { bufferCommands: false };\n    cached.promise = mongoose.connect(MONGODB_URI!, opts);\n  }\n  cached.conn = await cached.promise;\n  return cached.conn;\n}"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,SAAS;AAEzC,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MAAM;AAClB;AAOA,IAAI,SAAiB,AAAC,OAAe,QAAQ;AAE7C,IAAI,CAAC,QAAQ;IACX,SAAS,AAAC,OAAe,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AAClE;AAEO,eAAe;IACpB,IAAI,OAAO,IAAI,EAAE,OAAO,OAAO,IAAI;IAEnC,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YAAE,gBAAgB;QAAM;QACrC,OAAO,OAAO,GAAG,yGAAA,CAAA,UAAQ,CAAC,OAAO,CAAC,aAAc;IAClD;IACA,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IAClC,OAAO,OAAO,IAAI;AACpB","debugId":null}},
    {"offset": {"line": 210, "column": 0}, "map": {"version":3,"sources":["file:///home/muhammedshibilin/nextjs/harfa/model./product.model.ts"],"sourcesContent":["// models/Product.ts\nimport mongoose, { Schema, model, Document } from 'mongoose';\n\ninterface IProduct extends Document {\n  name: string;\n  price: number;\n  category: mongoose.Types.ObjectId;\n  isBlocked: boolean;\n  createdAt: Date;\n}\n\nconst ProductSchema: Schema = new Schema({\n  name: { type: String, required: true },\n  price: { type: Number, required: true },\n  category: { type: Schema.Types.ObjectId, ref: 'Category', required: true },\n  isBlocked: { type: Boolean, default: false },\n  createdAt: { type: Date, default: Date.now },\n});\n\nexport default mongoose.models.Product || model<IProduct>('Product', ProductSchema);"],"names":[],"mappings":"AAAA,oBAAoB;;;;AACpB;;AAUA,MAAM,gBAAwB,IAAI,yGAAA,CAAA,SAAM,CAAC;IACvC,MAAM;QAAE,MAAM;QAAQ,UAAU;IAAK;IACrC,OAAO;QAAE,MAAM;QAAQ,UAAU;IAAK;IACtC,UAAU;QAAE,MAAM,yGAAA,CAAA,SAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAY,UAAU;IAAK;IACzE,WAAW;QAAE,MAAM;QAAS,SAAS;IAAM;IAC3C,WAAW;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;AAC7C;uCAEe,yGAAA,CAAA,UAAQ,CAAC,MAAM,CAAC,OAAO,IAAI,CAAA,GAAA,yGAAA,CAAA,QAAK,AAAD,EAAY,WAAW","debugId":null}},
    {"offset": {"line": 246, "column": 0}, "map": {"version":3,"sources":["file:///home/muhammedshibilin/nextjs/harfa/app/backend/products/route.ts"],"sourcesContent":["// app/api/products/route.ts\nimport { NextRequest, NextResponse } from 'next/server';\n\nimport { verifyToken } from '@/lib/paseto';\nimport { dbConnect } from '@/lib/db';\nimport productModel from '@/model./product.model';\n\nexport async function GET(req: NextRequest) {\n  await dbConnect();\n  const token = req.headers.get('authorization')?.split(' ')[1];\n  const payload = token ? await verifyToken(token) : null;\n\n  if (!payload || payload.role !== 'admin') {\n    return NextResponse.json({ message: 'Unauthorized' }, { status: 401 });\n  }\n\n  const products = await productModel.find().populate('category');\n  return NextResponse.json(products);\n}"],"names":[],"mappings":"AAAA,4BAA4B;;;;AAC5B;AAEA;AACA;AACA;;;;;AAEO,eAAe,IAAI,GAAgB;IACxC,MAAM,CAAA,GAAA,2GAAA,CAAA,YAAS,AAAD;IACd,MAAM,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,kBAAkB,MAAM,IAAI,CAAC,EAAE;IAC7D,MAAM,UAAU,QAAQ,MAAM,CAAA,GAAA,+GAAA,CAAA,cAAW,AAAD,EAAE,SAAS;IAEnD,IAAI,CAAC,WAAW,QAAQ,IAAI,KAAK,SAAS;QACxC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAe,GAAG;YAAE,QAAQ;QAAI;IACtE;IAEA,MAAM,WAAW,MAAM,6HAAA,CAAA,UAAY,CAAC,IAAI,GAAG,QAAQ,CAAC;IACpD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;AAC3B","debugId":null}}]
}