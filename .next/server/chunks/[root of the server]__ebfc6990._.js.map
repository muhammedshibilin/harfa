{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///home/muhammedshibilin/nextjs/harfa/lib/paseto.ts"],"sourcesContent":["// lib/paseto.ts\nimport { V4 } from 'paseto';\nimport { Buffer } from 'node:buffer';\n\n// Instantiate V4\n\nconst privateKey = (() => {\n  const key = process.env.PASETO_PRIVATE_KEY;\n  if (!key) throw new Error('PASETO_PRIVATE_KEY is missing from environment variables');\n  console.log('Private Key:', key, 'Length (chars):', key.length);\n  const buffer = Buffer.from(key, 'base64');\n  if (buffer.length !== 64) {\n    console.error(`Private key length is ${buffer.length}, expected 64 bytes`);\n    throw new Error('Invalid PASETO_PRIVATE_KEY length');\n  }\n  return buffer;\n})();\n\nconst publicKey = (() => {\n  const key = process.env.PASETO_PUBLIC_KEY;\n  if (!key) throw new Error('PASETO_PUBLIC_KEY is missing from environment variables');\n  console.log('Public Key:', key, 'Length (chars):', key.length);\n  const buffer = Buffer.from(key, 'base64');\n  if (buffer.length !== 32) {\n    console.error(`Public key length is ${buffer.length}, expected 32 bytes`);\n    throw new Error('Invalid PASETO_PUBLIC_KEY length');\n  }\n  return buffer;\n})();\n\ninterface TokenPayload {\n  role: string;\n  username: string;\n  iat?:Date;\n  exp?:Date;\n  iss?:string;\n  sub?:string\n}\n\nexport async function generateToken(payload: TokenPayload): Promise<string> {\n  try {\n    const payloadObject: Record<string, unknown> = { ...payload };\n    console.log('ypayload object',payloadObject)\n    return await V4.sign(payloadObject, privateKey, {\n      expiresIn: '1h',\n      audience: 'http://localhost:3000',\n      issuer: 'http://localhost:3000/backend',\n      subject: payload.username,\n    });\n  } catch (error) {\n    console.error('Failed to generate PASETO token:', error);\n    throw new Error('Token generation failed');\n  }\n}\n\nexport async function verifyToken(token: string): Promise<TokenPayload | null> {\n    try {\n      console.log('Verifying token:', token);\n      const verified = await V4.verify(token, publicKey, {\n        audience: 'http://localhost:3000',\n        issuer: 'http://localhost:3000/backend',\n      });\n  \n      console.log('Verified payload:', verified);\n      return verified as unknown as TokenPayload\n    } catch (error) {\n      console.warn('Failed to verify PASETO token:', error);\n      return null;\n    }\n  }\n  \n"],"names":[],"mappings":"AAAA,gBAAgB;;;;;AAChB;AACA;;;AAEA,iBAAiB;AAEjB,MAAM,aAAa,CAAC;IAClB,MAAM,MAAM,QAAQ,GAAG,CAAC,kBAAkB;IAC1C,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,QAAQ,GAAG,CAAC,gBAAgB,KAAK,mBAAmB,IAAI,MAAM;IAC9D,MAAM,SAAS,qHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,KAAK;IAChC,IAAI,OAAO,MAAM,KAAK,IAAI;QACxB,QAAQ,KAAK,CAAC,CAAC,sBAAsB,EAAE,OAAO,MAAM,CAAC,mBAAmB,CAAC;QACzE,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT,CAAC;AAED,MAAM,YAAY,CAAC;IACjB,MAAM,MAAM,QAAQ,GAAG,CAAC,iBAAiB;IACzC,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,QAAQ,GAAG,CAAC,eAAe,KAAK,mBAAmB,IAAI,MAAM;IAC7D,MAAM,SAAS,qHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,KAAK;IAChC,IAAI,OAAO,MAAM,KAAK,IAAI;QACxB,QAAQ,KAAK,CAAC,CAAC,qBAAqB,EAAE,OAAO,MAAM,CAAC,mBAAmB,CAAC;QACxE,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT,CAAC;AAWM,eAAe,cAAc,OAAqB;IACvD,IAAI;QACF,MAAM,gBAAyC;YAAE,GAAG,OAAO;QAAC;QAC5D,QAAQ,GAAG,CAAC,mBAAkB;QAC9B,OAAO,MAAM,wIAAA,CAAA,KAAE,CAAC,IAAI,CAAC,eAAe,YAAY;YAC9C,WAAW;YACX,UAAU;YACV,QAAQ;YACR,SAAS,QAAQ,QAAQ;QAC3B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oCAAoC;QAClD,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,eAAe,YAAY,KAAa;IAC3C,IAAI;QACF,QAAQ,GAAG,CAAC,oBAAoB;QAChC,MAAM,WAAW,MAAM,wIAAA,CAAA,KAAE,CAAC,MAAM,CAAC,OAAO,WAAW;YACjD,UAAU;YACV,QAAQ;QACV;QAEA,QAAQ,GAAG,CAAC,qBAAqB;QACjC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,IAAI,CAAC,kCAAkC;QAC/C,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///home/muhammedshibilin/nextjs/harfa/app/backend/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { generateToken } from '@/lib/paseto';\n\nexport async function POST(req: NextRequest) {\n  const { username, password } = await req.json();\n  const adminUsername = process.env.ADMIN_USERNAME;\n  const adminPassword = process.env.ADMIN_PASSWORD;\n\n  if (username !== adminUsername || password !== adminPassword) {\n    return NextResponse.json({ message: 'Invalid credentials' }, { status: 401 });\n  }\n\n  try {\n    const token = await generateToken({ role: 'admin', username });\n    console.log('token in login api',token)\n    const tokenParts = token.split('.');\nconst payloadBase64 = tokenParts[1];\nconst payloadDecoded = Buffer.from(payloadBase64, 'base64').toString('utf8');\nconsole.log('Decoded payload:', payloadDecoded);\n    return NextResponse.json({ token });\n  } catch (error) {\n    console.error('Failed to create token:', error);\n    return NextResponse.json({ message: 'Token creation failed' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACzC,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;IAC7C,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc;IAChD,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc;IAEhD,IAAI,aAAa,iBAAiB,aAAa,eAAe;QAC5D,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAsB,GAAG;YAAE,QAAQ;QAAI;IAC7E;IAEA,IAAI;QACF,MAAM,QAAQ,MAAM,CAAA,GAAA,+GAAA,CAAA,gBAAa,AAAD,EAAE;YAAE,MAAM;YAAS;QAAS;QAC5D,QAAQ,GAAG,CAAC,sBAAqB;QACjC,MAAM,aAAa,MAAM,KAAK,CAAC;QACnC,MAAM,gBAAgB,UAAU,CAAC,EAAE;QACnC,MAAM,iBAAiB,OAAO,IAAI,CAAC,eAAe,UAAU,QAAQ,CAAC;QACrE,QAAQ,GAAG,CAAC,oBAAoB;QAC5B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE;QAAM;IACnC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACF","debugId":null}}]
}